# Frontend Integration Guide: Pro Inventory Management (V3)

–≠—Ç–æ—Ç –≥–∞–π–¥ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ (Dashboard, –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, Waste KPI) –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥.

## 1. –ù–æ–≤—ã–µ API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **GET** | `/api/inventory/dashboard` | üî• **–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –≤–ª–∞–¥–µ–ª—å—Ü–∞** (KPI, —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞, —Ä–∏—Å–∫–∏) |
| **GET** | `/api/inventory/products` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –¥–µ—Ç–∞–ª—è–º–∏ (–∏–Ω—Ñ–æ –æ–± –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–µ) |
| **GET** | `/api/inventory/health` | –°—Ç–∞—Ç—É—Å "–∑–¥–æ—Ä–æ–≤—å—è" —Å–∫–ª–∞–¥–∞ –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤ |
| **GET** | `/api/inventory/alerts` | –°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤ (–ø—Ä–æ—Å—Ä–æ—á–∫–∞, –Ω–µ—Ö–≤–∞—Ç–∫–∞) |
| **GET** | `/api/inventory/reports/loss?days=30` | –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ —É–±—ã—Ç–∫–∞–º –∏ Waste KPI |
| **POST** | `/api/inventory/process-expirations` | –ö–æ–º–∞–Ω–¥–∞ –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ–π –ø—Ä–æ—Å—Ä–æ—á–∫–∏ |

---

## 2. –ú–æ–¥–µ–ª–∏ –î–∞–Ω–Ω—ã—Ö (TypeScript)

–î–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ —Ç–∏–ø—ã –≤ `src/types/inventory.ts`:

```typescript
// –ì–ª–∞–≤–Ω—ã–π Dashboard –í–ª–∞–¥–µ–ª—å—Ü–∞
export interface InventoryDashboard {
  total_stock_value_cents: number; // –û–±—â–∞—è —Å—É–º–º–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ (PLN = cents/100)
  waste_30d_cents: number;        // –ü–æ—Ç–µ—Ä–∏ –∑–∞ 30 –¥–Ω–µ–π –≤ –≤–∞–ª—é—Ç–µ
  waste_percentage: number;       // % –ø–æ—Ç–µ—Ä—å (Waste KPI)
  health_score: number;           // 0-100 (–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π —Å—á–µ—Ç)
  stockout_risks: StockoutPrediction[]; // –ü—Ä–æ–≥–Ω–æ–∑: –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è —Ç–æ–≤–∞—Ä (–Ω–∞ –±–∞–∑–µ 14 –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂)
  expired_risks: RiskProduct[];         // –†–∏—Å–∫–∏: —á—Ç–æ —Å–∫–æ—Ä–æ –ø—Ä–æ—Å—Ä–æ—á–∏—Ç—Å—è (–±–ª–∏–∂–∞–π—à–∏–µ 3 –¥–Ω—è)
}

export interface StockoutPrediction {
  ingredient_id: string;
  name: string;
  current_quantity: number;
  avg_daily_consumption: number;
  days_until_stockout: number; // number.POSITIVE_INFINITY –µ—Å–ª–∏ –Ω–µ—Ç —Ä–∞—Å—Ö–æ–¥–∞
}

export interface RiskProduct {
  ingredient_id: string;
  name: string;
  status: string; // "Expired" | "Critical" | "Warning"
  batch_id: string;
  remaining_quantity: number;
}

// –°—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è —Å–∫–ª–∞–¥–∞ –¥–ª—è Dashboard
export interface InventoryStatus {
  health_score: number;     // 0-100
  status: string;           // "Excellent" | "Good" | "Warning" | "Critical"
  critical: number;         // –ö–æ–ª-–≤–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º (–ø—Ä–æ—Å—Ä–æ—á–∫–∞/–Ω–æ–ª—å)
  warning: number;          // –ö–æ–ª-–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è)
  expired: number;          // –ö–æ–ª-–≤–æ —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
  low_stock: number;        // –ö–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞
  badge_count: number;      // –ß–∏—Å–ª–æ –¥–ª—è –∫—Ä–∞—Å–Ω–æ–≥–æ –∫—Ä—É–∂–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
}

// –≠–ª–µ–º–µ–Ω—Ç –æ—Ç—á–µ—Ç–∞ –æ –ø–æ—Ç–µ—Ä—è—Ö
export interface LossReportItem {
  ingredient_id: string;
  ingredient_name: string;
  lost_quantity: number;
  loss_value_cents: number;
}

// –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç —Å KPI
export interface LossReport {
  items: LossReportItem[];
  total_loss_cents: number;
  total_purchased_cents: number;
  waste_percentage: number; // üî• –û—Å–Ω–æ–≤–Ω–æ–π –±–∏–∑–Ω–µ—Å-KPI (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3.8)
  period_days: number;
}
```

---

## 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Dashboard (UI)

### –í–∏–¥–∂–µ—Ç "–ó–¥–æ—Ä–æ–≤—å–µ —Å–∫–ª–∞–¥–∞"
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä—É–≥–æ–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (`Radix UI` –∏–ª–∏ `Shadcn UI`).

```tsx
const getStatusColor = (status: string) => {
  switch (status) {
    case 'Excellent': return 'text-green-500';
    case 'Good': return 'text-blue-500';
    case 'Warning': return 'text-yellow-500';
    case 'Critical': return 'text-red-500';
    default: return 'text-gray-500';
  }
};

// ... –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
<Card>
  <CardHeader>Inventory Health</CardHeader>
  <CardContent>
    <div className={`text-4xl font-bold ${getStatusColor(data.status)}`}>
      {data.health_score}%
    </div>
    <p className="text-sm text-muted-foreground">{data.status}</p>
    <div className="mt-4 flex gap-2">
       <Badge variant="destructive">Critical: {data.critical}</Badge>
       <Badge variant="outline">Low Stock: {data.low_stock}</Badge>
    </div>
  </CardContent>
</Card>
```

---

## 4. –≠–∫—Ä–∞–Ω "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—Ç–µ—Ä—å" (Analytics)

–ì–ª–∞–≤–Ω—ã–π "–≤–∞—É"-—ç—Ñ—Ñ–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **Waste Percentage**.

- **–ú–µ—Ç—Ä–∏–∫–∞ 1**: "–ü—Ä–æ—Ü–µ–Ω—Ç —Å–ø–∏—Å–∞–Ω–∏–π" (`waste_percentage`). –ï—Å–ª–∏ > 5%, –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –∫—Ä–∞—Å–Ω—ã–º.
- **–ú–µ—Ç—Ä–∏–∫–∞ 2**: "–û–±—â–∞—è —Å—É–º–º–∞ –ø–æ—Ç–µ—Ä—å" (`total_loss_cents / 100`).
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ—Å—Ä–æ—á–∫—É", –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç `/api/inventory/process-expirations`. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –≤—ã–∑–≤–∞—Ç—å `mutate()` –¥–ª—è —Ä–µ—Ñ—Ä–µ—à–∞ –¥–∞–Ω–Ω—ã—Ö.

---

## 5. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—ã (Mandatory Dates)

**–í–ù–ò–ú–ê–ù–ò–ï**: –° –≤–µ—Ä—Å–∏–∏ V3 –ø–æ–ª—è `received_at` –∏ `expires_at` —Å—Ç–∞–ª–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏** –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î –∏ API.

### –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ `POST /api/inventory/batches` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ:
- `received_at`: –î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è (ISO 8601, –Ω–∞–ø—Ä–∏–º–µ—Ä: `2023-10-27T10:00:00Z`).
- `expires_at`: –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏. –ù–µ–ª—å–∑—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –ø—É—Å—Ç—ã–º!

```typescript
// AddProductRequest
{
  "catalog_ingredient_id": "uuid",
  "price_per_unit_cents": 1000,
  "quantity": 10.5,
  "received_at": "2023-10-27T10:00:00Z", // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
  "expires_at": "2023-11-27T10:00:00Z"    // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
}
```

---

## 6. –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

1. **–í–∞–ª—é—Ç—ã**: –í—Å–µ —Å—É–º–º—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ **—Ü–µ–Ω—Ç–∞—Ö** (`i64`). –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∏—Ç–µ –Ω–∞ 100 –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
2. **–î–∞—Ç—ã**: –ë—ç–∫–µ–Ω–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `OffsetDateTime` –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `date-fns` –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `Intl.DateTimeFormat` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ª–æ–∫–∞–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
3. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ FIFO**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –±–æ–ª—å—à–µ –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Ç–æ–º, –∫–∞–∫—É—é –ø–∞—Ä—Ç–∏—é —Å–ø–∏—Å—ã–≤–∞—Ç—å. –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, –±—ç–∫–µ–Ω–¥ —Å–∞–º –≤—ã–±–µ—Ä–µ—Ç —Å–Ω–∞—á–∞–ª–∞ —Ç–æ, —á—Ç–æ –∏—Å–ø–æ—Ä—Ç–∏—Ç—Å—è —Ä–∞–Ω—å—à–µ (–ø–æ `expires_at`).
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –ü–æ—Å–ª–µ –ª—é–±–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –∏–ª–∏ –ø—Ä–æ–¥–∞–∂–∞), –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à `inventory/health`, —á—Ç–æ–±—ã `badge_count` –≤ —à–∞–ø–∫–µ –æ–±–Ω–æ–≤–∏–ª—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–æ.

---

## 7. "WOW" UI: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π Dashboard (–ü—Ä–∏–º–µ—Ä)

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–æ—Å—Å–æ–∑–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### –ö–∞—Ä—Ç–æ—á–∫–∞ "–ó–¥–æ—Ä–æ–≤—å–µ —Å–∫–ª–∞–¥–∞"
| –≠–ª–µ–º–µ–Ω—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ (–ü—Ä–∏–º–µ—Ä) | –¢–∏–ø/–¶–≤–µ—Ç |
| :--- | :--- | :--- |
| **75%** | `health_score` | Large Circle Progress (Yellow) |
| **–ó–¥–æ—Ä–æ–≤—å–µ —Å–∫–ª–∞–¥–∞** | –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –¢–µ–∫—Å—Ç |
| **–•–æ—Ä–æ—à–æ** | `status` | Badge (Blue/Yellow) |
| *–û–±—â–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∞—Å–∞–º–∏* | –û–ø–∏—Å–∞–Ω–∏–µ | Small Muted Text |

**–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º:**
- **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ:** `{expired}` (–ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ > 0)
- **–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è:** `{critical}` (–û—Ä–∞–Ω–∂–µ–≤—ã–π —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ > 0)
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:** `{warning}` (–ñ–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ > 0)

---

### –ö–∞—Ä—Ç–æ—á–∫–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—Ç–µ—Ä—å" (–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
| –≠–ª–µ–º–µ–Ω—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ (–ü—Ä–∏–º–µ—Ä) | –¢–∏–ø/–¶–≤–µ—Ç |
| :--- | :--- | :--- |
| **3.8%** | `waste_percentage` | Large Value (Red/Green) |
| **Waste KPI** | –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ | –¢–µ–∫—Å—Ç |
| **–í—Å–µ–≥–æ –ø–æ—Ç–µ—Ä—å** | `total_loss_cents / 100` PLN | Currency Format |

**–ì–ª–∞–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:**
- **–ö–Ω–æ–ø–∫–∞:** `[ –ó–∞–ø—É—Å—Ç–∏—Ç—å FIFO –∫–ª–∏–Ω–∏–Ω–≥ ]`
- **–î–µ–π—Å—Ç–≤–∏–µ:** –í—ã–∑–æ–≤ `POST /api/inventory/process-expirations`
- **–≠—Ñ—Ñ–µ–∫—Ç:** –ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 0, –∞ Health Score —Ä–∞—Å—Ç–µ—Ç.

---

## 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ (Backend Logic)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –∫–∞–∫ "Low Stock" –∏–ª–∏ "Critical" –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:
1. **Low Stock (< 0.5 –∫–≥)**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `min_stock_threshold = 0.5` –¥–ª—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ `catalog_ingredients`.
2. **Zero Stock**: –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = 0, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Ç–∞–µ—Ç **25 –ø—É–Ω–∫—Ç–æ–≤** –∏–∑ Health Score –∏ –ø–æ–º–µ—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–∞–∫ `Critical`.
3. **FIFO Cleaning**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –±—ç–∫–µ–Ω–¥ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤—Å–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä—Ç–∏–∏ (`expires_at < NOW()`) –≤ —Å—Ç–∞—Ç—É—Å `Exhausted`, –æ–±–Ω—É–ª—è–µ—Ç –∏—Ö –æ—Å—Ç–∞—Ç–æ–∫ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É–±—ã—Ç–æ–∫.
