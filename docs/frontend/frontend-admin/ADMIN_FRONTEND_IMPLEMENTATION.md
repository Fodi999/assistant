# Гайд по реализации Admin Panel (SuperAdmin)

Этот документ описывает логику интеграции фронтенда с SuperAdmin эндпоинтами бэкенда.

## 1. Авторизация (SuperAdmin Login)

Супер-админ использует **отдельный** процесс входа и JWT-секрет.

- **Endpoint**: `POST /api/admin/auth/login`
- **Payload**: `{"email": "...", "password": "..."}`
- **Storage**: Сохраняйте токен в `admin_token` (отдельно от обычного пользователя).
- **Verify**: `GET /api/admin/auth/verify` (проверка токена при загрузке страницы).

## 2. Управление глобальным каталогом (Catalog Management)

Главная задача админки — наполнение базы данных, которой потом пользуются все рестораны.

### Создание ингредиента
При создании ингредиента фронтенд **обязан** отправлять названия на всех 4 языках:
```typescript
{
  "name_pl": "Mleko",
  "name_en": "Milk",
  "name_uk": "Молоко",
  "name_ru": "Молоко",
  "category_id": "uuid",
  "default_unit": "liter",
  // ... сезонность, аллергены
}
```

### Удаление продуктов (Soft Delete)
Удаление продукта из глобального каталога происходит «мягко»: продукт помечается как `is_active = false`. Это сохраняет целостность данных в ресторанах, которые уже добавили этот продукт к себе в инвентарь.

- **Endpoint**: `DELETE /api/admin/catalog/products/:id`
- **Auth**: Требуется `AdminClaims` (заголовок `Authorization: Bearer <admin_token>`).
- **Response**: `204 No Content` при успехе.

> ⚠️ **Важно**: После удаления продукт перестанет появляться в поиске и общем списке каталога, но останется в базе для аналитики и исторических записей.

### Управление категориями
Категории необходимы для группировки продуктов в каталоге.

- **GET** `/api/admin/catalog/categories` — список всех категорий.
- **POST** `/api/admin/catalog/categories` — создание новой категории.
  ```json
  {
    "name_en": "Vegetables",
    "name_ru": "Овощи",
    "name_pl": "Warzywa",
    "name_uk": "Овочі",
    "is_active": true
  }
  ```
- **PUT** `/api/admin/catalog/categories/:id` — обновление.
- **DELETE** `/api/admin/catalog/categories/:id` — удаление.

### Загрузка изображений (Professional Flow)
Для каталога используйте ту же схему, что и для аватарок:
1. `GET /api/admin/products/:id/image-url` (получить presigned-ссылку).
2. Загрузка в R2 с фронта.
3. Сохранение URL через вызов бэкенда.

## 3. Мониторинг пользователей (User Management)

Используйте для дашборда главной страницы:
- **GET** `/api/admin/stats` — возвращает количество пользователей, тенантов и общую активность.
- **GET** `/api/admin/users` — список всех пользователей платформы с пагинацией.

## 4. UI рекомендации (SaaS Style)

### Sidebar (Боковое меню)
- **Dashboard** (Статистика)
- **Catalog** (Управление товарами)
- **Categories** (Группы товаров)
- **Users** (Пользователи системы)
- **Settings** (Настройки платформы)

### Data Table (TanStack Table)
Для каталога критически важна хорошая таблица с:
- Фильтрацией по категориям.
- Поиском по названию (Fuzzy search).
- Быстрым переключением цен и наличия фото.

---

## 5. Переменные окружения (.env.local)

```env
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_CDN_URL=https://assets.restoai.com
```
